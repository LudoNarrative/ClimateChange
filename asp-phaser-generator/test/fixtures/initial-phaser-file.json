[
  {
    "l":["prog"],
    "relation": "is_a",
    "r":["program"],
    "preload": {"images":[]},
    "create":{"vars":[],"sprites":[],"listeners":[],"buttons":[],"motion":[]},
    "update":{"vars":[],"functions":[],"outcomes":[],"motion":[],"misc":[]},
    "render":{}
  },
  {
    "l":["variables"],
    "relation":"is_a",
    "r":["variable"],
    "value":{"confidence":5,"optimism":2,"difficulty":3}
  },
  {
    "l":["gridSize"],
    "relation":"is_a",
    "r":["variable"],
    "value":30
  },
  {
    "l":["gridLinesHorizontal"],
    "relation":"is_a",
    "r":["variable"],
    "value":"Math.floor((game.width-1)/gridSize)"
  },
  {
    "l":["gridLinesVertical"],
    "relation":"is_a",
    "r":["variable"],
    "value":"Math.floor((game.height-1)/gridSize)"
  },
  {
    "l":["grid"],
    "relation":"is_a",
    "r":["variable"],
    "value":"initGrid()"
  },
  {
    "l":["gridIdx"],
    "relation":"is_a",
    "r":["variable"],
    "value":0
  },
  {
    "l":["addedEntities"],
    "relation":"is_a",
    "r":["variable"],
    "value":["{}"]
  },
  {
    "l":["low"],
    "relation":"is_a",
    "r":["variable"],
    "value":1
  },
  {
    "l":["medium"],
    "relation":"is_a",
    "r":["variable"],
    "value":6
  },
  {
    "l":["mid"],
    "relation":"is_a",
    "r":["variable"],
    "value":"medium"
  },
  {
    "l":["high"],
    "relation":"is_a",
    "r":["variable"],
    "value":11
  },
  {
    "l":["circle"],
    "relation":"is_a",
    "r":["sprite"],
    "image":"circle.png",
    "width":40,
    "height":40
  },
  {
    "l":["pentagon"],
    "relation":"is_a",
    "r":["sprite"],
    "image":"pentagon.png",
    "width":40,
    "height":40
  },
  {
    "l":["triangle"],
    "relation":"is_a",
    "r":["sprite"],
    "image":"triangle.png",
    "width":40,
    "height":40
  },
  {
    "l":["star"],
    "relation":"is_a",
    "r":["sprite"],
    "image":"star.png",
    "width":40,
    "height":40
  },
  {
    "l":["square"],
    "relation":"is_a",
    "r":["sprite"],
    "image":"square.png",
    "width":40,
    "height":40
  },
  {
    "l":["center"],
    "relation":"is_a",
    "r":["location"],
    "x":160,
    "y":220
  },
  {
    "l":["lower_left"],
    "relation":"is_a",
    "r":["location"],
    "x":100,
    "y":300
  },
  {
    "l":["upper_right"],
    "relation":"is_a",
    "r":["location"],
    "x":300,
    "y":100
  },
  {
    "l":["setVariable"],
    "relation":"is_a",
    "r":["function"],
    "params":["varName","value"],
    "lines":["variables[varName]=value;","State.set(varName, value);","StoryAssembler.refreshNarrative();","Display.setAvatar(State);"]
  },
  {
    "l":["getVariable"],
    "relation":"is_a",
    "r":["function"],
    "params":["varName"],
    "lines":["return variables[varName];"]
  },
  {
    "l":["getRandomPoint"],
    "relation":"is_a",
    "r":["function"],
    "params":[],
    "lines":["var x=game.rnd.integerInRange(0,game.world.width-1);","var y=game.rnd.integerInRange(0,game.world.height-1);","return new Phaser.Point(x,y);"]
  },
  {
    "l":["initGrid"],
    "relation":"is_a",
    "r":["function"],
    "params":[],
    "lines":["grid=[];","for(var i=0;i<gridLinesHorizontal;i++){for(var j=0;j<gridLinesVertical;j++){grid.push(new Phaser.Point(i*gridSize,j*gridSize));}}","shuffle(grid);","return grid;"]
  },
  {
    "l":["addAtRandomPoint"],
    "relation":"is_a",
    "r":["function"],
    "params":["sprite"],
    "lines":["var spawned=addAtPos(grid[gridIdx], sprite);","gridIdx++;","if(gridIdx===grid.length){gridIdx=0;shuffle(grid);}","return spawned;"]
  },
  {
    "l":["addAtPos"],
    "relation":"is_a",
    "r":["function"],
    "params":["point","sprite"],
    "lines":["return game.add.sprite(point.x,point.y,sprite);"]
  },
  {
    "l":["shuffle"],
    "relation":"is_a",
    "r":["function"],
    "params":["a"],
    "lines":["var j,x,i;","for(i=a.length;i;i--){j=Math.floor(Math.random()*i);x=a[i-1];a[i-1]=a[j];a[j]=x;}"]
  },
  {
    "l":["move_towards"],
    "relation":"is_a",
    "r":["function"],
    "params":["e","dir"],
    "lines":["e.directionChange.x += dir.x;","e.directionChange.y += dir.y;"]
  },
  {
    "l":["move_away"],
    "relation":"is_a",
    "r":["function"],
    "params":["e","dir"],
    "lines":["e.directionChange.x -= dir.x;","e.directionChange.y -= dir.y;"]
  },
  {
    "l":["move"],
    "relation":"is_a",
    "r":["function"],
    "params":["e","x","y"],
    "lines":["e.directionChange.x += x;","e.directionChange.y += y;"]
  },
  {
    "l":["initEntityProperties"],
    "relation":"is_a",
    "r":["function"],
    "params":["eName"],
    "lines":["game.physics.arcade.enable(addedEntities[eName]);","addedEntities[eName].body.collideWorldBounds = true;","if (!addedEntities[eName].body.velocity.hasOwnProperty('x')){addedEntities[eName].body.velocity.x=0;}","if (!addedEntities[eName].body.velocity.hasOwnProperty('y')){addedEntities[eName].body.velocity.y=0;}","if (!addedEntities[eName].body.hasOwnProperty('angularVelocity')){addedEntities[eName].body.angularVelocity=0;}","if (!addedEntities[eName].hasOwnProperty('directionChange')){addedEntities[eName].directionChange=new Phaser.Point(0,0);}"]
  },
  {
    "l":["changeMode"],
    "relation":"is_a",
    "r":["function"],
    "params":["newMode"],
    "lines":["if(newMode==='game_win'){mode = 'win'; game.world.removeAll(); displayText('CLEARED');}","else if(newMode==='game_loss'){mode='loss'; game.stage.backgroundColor = '#400';}"]
  },
  {
    "l":["displayText"],
    "relation":"is_a",
    "r":["function"],
    "params":["t"],
    "lines":["var style = { font: 'bold 32px Arial', fill: '#fff', boundsAlignH: 'center', boundsAlignV: 'middle'};","text = game.add.text(0, 0, t, style);"]
  },
  {
    "l":["goals"],
    "relation":"is_a",
    "r":["variable"],
    "value":["[]"]
  },
  {
    "l":["getAspGoals"],
    "relation":"is_a",
    "r":["function"],
    "params":[],
    "lines":["if (goals === undefined || goals.length == 0){return ['No ASP goals.'];}","else{return goals;}"]
  }
]
